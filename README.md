# 22-NAT
## 1. Теоретическая часть
В теоретической части нам необходимо продумать топологию сети, а
также:
● Найти свободные подсети
● Посчитать количество узлов в каждой подсети, включая свободные
● Указать Broadcast-адрес для каждой подсети
● Проверить, нет ли ошибок при разбиении

С помощью калькулятора сети получаем следующую таблицу топологии:

![Image alt](https://github.com/GuliMari/22-NAT/blob/main/%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B0.png)

Становится понятно, что ошибок в построении нет. Можно выделить свободные сети.

## В практической части требуется:    
● Соединить офисы в сеть согласно логической схеме и настроить роутинг    
● Интернет-трафик со всех серверов должен ходить через inetRouter    
● Все сервера должны видеть друг друга (должен проходить ping)     
● У всех новых серверов отключить дефолт на NAT (eth0), который vagrant поднимает для связи   
● Добавить дополнительные сетевые интерфейсы, если потребуется    

Настраиваем серверы согласно методичке с помощью `Ansible`. Запускаем.
Проверим выход в интернет через сервер inetRouter c хоста office2Server:

```bash
root@office2Server:~# traceroute ya.ru
traceroute to ya.ru (5.255.255.242), 30 hops max, 60 byte packets
 1  192.168.1.1 (192.168.1.1)  1.695 ms  1.263 ms  1.112 ms
 2  192.168.255.5 (192.168.255.5)  2.138 ms  1.930 ms  1.634 ms
 3  192.168.255.1 (192.168.255.1)  3.330 ms  3.117 ms  2.980 ms
 4  * * *
 5  * * *
 6  * * *
 ...
```
Видим, что запрос проходит через office2Router-->centralRouter-->inetRouter.

Проверим, видит ли office2Server, например, office1Server:

```bash
root@office2Server:~# ping 192.168.2.130
PING 192.168.2.130 (192.168.2.130) 56(84) bytes of data.
64 bytes from 192.168.2.130: icmp_seq=1 ttl=61 time=2.25 ms
64 bytes from 192.168.2.130: icmp_seq=2 ttl=61 time=3.48 ms
64 bytes from 192.168.2.130: icmp_seq=3 ttl=61 time=3.52 ms
...
root@office2Server:~# traceroute 192.168.2.130
traceroute to 192.168.2.130 (192.168.2.130), 30 hops max, 60 byte packets
 1  192.168.1.1 (192.168.1.1)  0.485 ms  0.444 ms  0.797 ms
 2  192.168.255.5 (192.168.255.5)  2.240 ms  2.091 ms  1.968 ms
 3  192.168.255.10 (192.168.255.10)  1.791 ms  2.761 ms  2.644 ms
 4  192.168.2.130 (192.168.2.130)  2.537 ms  2.380 ms  1.393 ms
 ```
 
